<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="MyShop.Client.Views.Customer.BecomeAgentPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:layout="using:MyShop.Client.Views.Components.Layout"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels="using:MyShop.Client.ViewModels.Customer"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Page.Transitions>
        <TransitionCollection>
            <EntranceThemeTransition FromVerticalOffset="50"/>
        </TransitionCollection>
    </Page.Transitions>

    <!-- Note: Using design system styles - CardWithShadowStyle for cards -->
    <!-- FormTextBoxStyle removed - using default TextBox style with consistent spacing -->

    <Grid>
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="ResponsiveStates">
                
                <!-- Large Desktop: 1920px+ -->
                <VisualState x:Name="LargeDesktopState">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="1920"/>
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="MainContent.Padding" Value="0,40,0,40"/>
                    </VisualState.Setters>
                </VisualState>

                <!-- Desktop: 1280-1919px -->
                <VisualState x:Name="DesktopState">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="1280"/>
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="MainContent.Padding" Value="0,40,0,40"/>
                    </VisualState.Setters>
                </VisualState>

                <!-- Tablet: 960-1279px -->
                <VisualState x:Name="TabletState">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="960"/>
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="MainContent.Padding" Value="0,32,0,32"/>
                    </VisualState.Setters>
                </VisualState>

                <!-- Tablet Portrait: 640-959px -->
                <VisualState x:Name="TabletPortraitState">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="640"/>
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="MainContent.Padding" Value="0,24,0,24"/>
                    </VisualState.Setters>
                </VisualState>

                <!-- Mobile: 0-639px (Default) -->
                <VisualState x:Name="MobileState">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="0"/>
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="MainContent.Padding" Value="0,16,0,16"/>
                    </VisualState.Setters>
                </VisualState>
                
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>

        <ScrollViewer x:Name="MainContent" Padding="0,40,0,40">
            <StackPanel MaxWidth="800" HorizontalAlignment="Center" Spacing="0">
            
            <!-- Page Header -->
            <layout:PageHeader
                Title="Become a Sales Agent"
                Subtitle="Apply to join our sales team"
                Margin="0,0,0,24"/>

            <!-- Existing Request Status Card (shows when user has a request) -->
            <Border Style="{StaticResource CardWithShadowStyle}" 
                    Margin="0,0,0,24"
                    Visibility="{x:Bind ViewModel.ShowRequestStatus, Mode=OneWay}">
                <StackPanel Spacing="16">
                    <!-- Status Header -->
                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <Border Width="48" Height="48" CornerRadius="24"
                                Background="{ThemeResource AccentBlueBrush}">
                            <FontIcon Glyph="&#xE735;" Foreground="{ThemeResource WhiteBrush}" FontSize="20"/>
                        </Border>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="Your Application Status" 
                                       FontWeight="SemiBold" 
                                       FontSize="18" 
                                       Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            <TextBlock Text="{x:Bind ViewModel.RequestDateDisplay, Mode=OneWay}"
                                       FontSize="14" 
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Status Badge -->
                    <Border Padding="12,8" CornerRadius="8" HorizontalAlignment="Left"
                            Background="{ThemeResource YellowLightBrush}">
                        <TextBlock Text="{x:Bind ViewModel.RequestStatusDisplay, Mode=OneWay}"
                                   FontWeight="SemiBold"
                                   FontSize="14"
                                   Foreground="{ThemeResource YellowDarkBrush}"/>
                    </Border>

                    <!-- Status Message -->
                    <TextBlock Text="{x:Bind ViewModel.RequestStatusMessage, Mode=OneWay}"
                               TextWrapping="Wrap"
                               FontSize="15"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>

                    <!-- Rejection Reason (if rejected) -->
                    <InfoBar IsOpen="{x:Bind ViewModel.HasRejectedRequest, Mode=OneWay}"
                             Severity="Error"
                             Title="Reason for Rejection"
                             Message="{x:Bind ViewModel.RejectionReason, Mode=OneWay}"
                             IsClosable="False"/>

                    <!-- Application Details -->
                    <StackPanel Spacing="8">
                        <TextBlock Text="Application Details" 
                                   FontWeight="SemiBold"
                                   FontSize="14"
                                   Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                        <Grid ColumnSpacing="16" RowSpacing="8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Full Name:" 
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" 
                                       Text="{x:Bind ViewModel.MyRequest.FullName, Mode=OneWay}"
                                       FontWeight="SemiBold"/>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Email:" 
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" 
                                       Text="{x:Bind ViewModel.MyRequest.Email, Mode=OneWay}"
                                       FontWeight="SemiBold"/>

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Phone:" 
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" 
                                       Text="{x:Bind ViewModel.MyRequest.PhoneNumber, Mode=OneWay}"
                                       FontWeight="SemiBold"/>
                        </Grid>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Header (only show when no request or rejected) -->
            <StackPanel HorizontalAlignment="Center" 
                        Margin="0,0,0,40"
                        Visibility="{x:Bind ViewModel.ShowSubmitForm, Mode=OneWay}">
                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" 
                        BorderThickness="1" 
                        CornerRadius="8" 
                        HorizontalAlignment="Center" 
                        Padding="12,6" 
                        Margin="0,0,0,16">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <FontIcon Glyph="&#xE735;" FontSize="12" Foreground="{ThemeResource AccentBlueBrush}"/>
                        <TextBlock Text="Become a Sales Agent" FontSize="12" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </Border>
                <TextBlock Text="Sales Agent Application" 
                           FontSize="28" 
                           FontWeight="Bold" 
                           Foreground="{ThemeResource TextFillColorPrimaryBrush}" 
                           HorizontalAlignment="Center" 
                           Margin="0,0,0,12"/>
                <TextBlock Text="Join our network of successful sales agents. Fill out the form below to start your journey with MyShop 2025." 
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                           FontSize="16" 
                           TextWrapping="Wrap" 
                           TextAlignment="Center" 
                           MaxWidth="600"/>
            </StackPanel>

            <!-- Personal Information Card -->
            <Border Style="{StaticResource CardWithShadowStyle}" 
                    Margin="0,0,0,24"
                    Visibility="{x:Bind ViewModel.ShowSubmitForm, Mode=OneWay}">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,24">
                        <Border Width="40" Height="40" CornerRadius="8" Margin="0,0,12,0"
                                Background="{ThemeResource AccentBlueBrush}">
                            <FontIcon Glyph="&#xE77B;" Foreground="{ThemeResource WhiteBrush}" FontSize="16"/>
                        </Border>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="Personal Information" 
                                       FontWeight="SemiBold" 
                                       FontSize="16" 
                                       Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            <TextBlock Text="Tell us about yourself" 
                                       FontSize="14" 
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                        </StackPanel>
                    </StackPanel>

                    <Grid ColumnSpacing="24">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBox x:Name="FullNameTextBox"
                                 Header="Full Name *" 
                                 PlaceholderText="Enter your full name" 
                                 Grid.Column="0"
                                 Margin="0,0,0,16"
                                 Text="{x:Bind ViewModel.FullName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                        
                        <TextBox x:Name="EmailTextBox"
                                 Header="Email Address *" 
                                 PlaceholderText="your.email@example.com" 
                                 Grid.Column="1" 
                                 InputScope="EmailSmtpAddress"
                                 Margin="0,0,0,16"
                                 Text="{x:Bind ViewModel.Email, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                    </Grid>
                    
                    <TextBox x:Name="PhoneTextBox"
                             Header="Phone Number *" 
                             PlaceholderText="+84 987 654 321" 
                             InputScope="TelephoneNumber"
                             Margin="0,0,0,16"
                             Text="{x:Bind ViewModel.PhoneNumber, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                </StackPanel>
            </Border>

            <!-- Address Information Card -->
            <Border Style="{StaticResource CardWithShadowStyle}" 
                    Margin="0,0,0,24"
                    Visibility="{x:Bind ViewModel.ShowSubmitForm, Mode=OneWay}">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,24">
                        <Border Width="40" Height="40" CornerRadius="8" Margin="0,0,12,0"
                                Background="{ThemeResource SecondaryBlueBrush}">
                            <FontIcon Glyph="&#xE707;" Foreground="{ThemeResource WhiteBrush}" FontSize="16"/>
                        </Border>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="Address Information" 
                                       FontWeight="SemiBold" 
                                       FontSize="16" 
                                       Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            <TextBlock Text="Where are you located?" 
                                       FontSize="14" 
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                        </StackPanel>
                    </StackPanel>

                    <TextBox Header="Street Address *" 
                             PlaceholderText="123 Main Street"
                             Margin="0,0,0,16"
                             Text="{x:Bind ViewModel.StreetAddress, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

                    <Grid ColumnSpacing="24">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Header="City *" 
                                 PlaceholderText="Ho Chi Minh City" 
                                 Grid.Column="0"
                                 Margin="0,0,0,16"
                                 Text="{x:Bind ViewModel.City, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                        <TextBox Header="State/Province *" 
                                 PlaceholderText="Vietnam" 
                                 Grid.Column="1"
                                 Margin="0,0,0,16"
                                 Text="{x:Bind ViewModel.StateProvince, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Business Information Card -->
            <Border Style="{StaticResource CardWithShadowStyle}" 
                    Margin="0,0,0,24"
                    Visibility="{x:Bind ViewModel.ShowSubmitForm, Mode=OneWay}">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,24">
                        <Border Width="40" Height="40" CornerRadius="8" Margin="0,0,12,0"
                                Background="{ThemeResource PurpleBrush}">
                            <FontIcon Glyph="&#xEC07;" Foreground="{ThemeResource WhiteBrush}" FontSize="16"/>
                        </Border>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="Business Information" 
                                       FontWeight="SemiBold" 
                                       FontSize="16" 
                                       Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            <TextBlock Text="Optional - If you have a registered business" 
                                       FontSize="14" 
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                        </StackPanel>
                    </StackPanel>

                    <Grid ColumnSpacing="24">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Header="Business Name" 
                                 PlaceholderText="Your Business LLC" 
                                 Grid.Column="0"
                                 Margin="0,0,0,16"
                                 Text="{x:Bind ViewModel.BusinessName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                        <TextBox Header="Tax ID / Business Registration" 
                                 PlaceholderText="XX-XXXXXXX" 
                                 Grid.Column="1"
                                 Margin="0,0,0,16"
                                 Text="{x:Bind ViewModel.TaxId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Experience and Motivation Card -->
            <Border Style="{StaticResource CardWithShadowStyle}" 
                    Margin="0,0,0,24"
                    Visibility="{x:Bind ViewModel.ShowSubmitForm, Mode=OneWay}">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,24">
                        <Border Width="40" Height="40" CornerRadius="8" Margin="0,0,12,0"
                                Background="{ThemeResource SuccessGreenBrush}">
                            <FontIcon Glyph="&#xE8F1;" Foreground="{ThemeResource WhiteBrush}" FontSize="16"/>
                        </Border>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="Experience and Motivation" 
                                       FontWeight="SemiBold" 
                                       FontSize="16" 
                                       Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            <TextBlock Text="Tell us about your background" 
                                       FontSize="14" 
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                        </StackPanel>
                    </StackPanel>

                    <TextBox Header="Previous Sales Experience *" 
                             PlaceholderText="Describe your previous sales experience, relevant skills, and achievements..."
                             AcceptsReturn="True" 
                             TextWrapping="Wrap" 
                             MinHeight="100"
                             Margin="0,0,0,16"
                             Text="{x:Bind ViewModel.SalesExperience, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                    
                    <TextBox Header="Why do you want to become a Sales Agent? *" 
                             PlaceholderText="Tell us what motivates you to join our sales agent network..."
                             AcceptsReturn="True" 
                             TextWrapping="Wrap" 
                             MinHeight="100"
                             Text="{x:Bind ViewModel.Motivation, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                </StackPanel>
            </Border>

            <!-- Terms and Submit -->
            <StackPanel Spacing="16"
                        Visibility="{x:Bind ViewModel.ShowSubmitForm, Mode=OneWay}">
                <Border Style="{StaticResource CardWithShadowStyle}">
                    <CheckBox IsChecked="{x:Bind ViewModel.AgreeToTerms, Mode=TwoWay}" FontSize="14">
                        <CheckBox.Content>
                            <TextBlock TextWrapping="Wrap">
                                <Run Text="I agree to the "/>
                                <Hyperlink NavigateUri="https://myshop.com/terms">Terms and Conditions</Hyperlink>
                                <Run Text=" *"/>
                                <LineBreak/>
                                <Run Text="By submitting this application, I confirm that all information provided is accurate and I agree to MyShop's " 
                                     Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                                     FontSize="12"/>
                                <Hyperlink NavigateUri="https://myshop.com/terms" FontSize="12">Terms of Service</Hyperlink>
                                <Run Text=", " Foreground="{ThemeResource TextFillColorSecondaryBrush}" FontSize="12"/>
                                <Hyperlink NavigateUri="https://myshop.com/agent-agreement" FontSize="12">Sales Agent Agreement</Hyperlink>
                                <Run Text=", and " Foreground="{ThemeResource TextFillColorSecondaryBrush}" FontSize="12"/>
                                <Hyperlink NavigateUri="https://myshop.com/privacy" FontSize="12">Privacy Policy</Hyperlink>
                                <Run Text=". I understand that there is a 10% platform fee on all sales." 
                                     Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                                     FontSize="12"/>
                            </TextBlock>
                        </CheckBox.Content>
                    </CheckBox>
                </Border>

                <Grid ColumnSpacing="16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <Button Grid.Column="1" 
                            Style="{StaticResource PrimaryButtonStyle}"
                            HorizontalAlignment="Stretch"
                            Background="{ThemeResource AccentButtonGradient}"
                            Command="{x:Bind ViewModel.SubmitCommand}"
                            IsEnabled="{x:Bind ViewModel.CanSubmit, Mode=OneWay}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <ProgressRing Width="16" 
                                          Height="16" 
                                          IsActive="{x:Bind ViewModel.IsSubmitting, Mode=OneWay}"
                                          Visibility="{x:Bind ViewModel.IsSubmitting, Mode=OneWay}"/>
                            <FontIcon Glyph="&#xE930;" 
                                      Foreground="{ThemeResource WhiteBrush}" 
                                      FontSize="16"
                                      Visibility="{x:Bind ViewModel.IsNotSubmitting, Mode=OneWay}"/>
                            <TextBlock Text="{x:Bind ViewModel.SubmitButtonText, Mode=OneWay}" 
                                       Foreground="{ThemeResource WhiteBrush}" 
                                       FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>
                </Grid>
                
                <TextBlock Text="Questions? Contact us at support@myshop.com" 
                           HorizontalAlignment="Center" 
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                           Margin="0,16,0,0"/>
            </StackPanel>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>
