<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="MyShop.Client.Views.Shared.ProductBrowsePage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:converters="using:MyShop.Client.Common.Converters"
    xmlns:vm="using:MyShop.Client.ViewModels.Shared"
    mc:Ignorable="d"
    Background="#F8FAFC">

    <Page.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <converters:StringFormatConverter x:Key="StringFormatConverter"/>
        <converters:BoolToStockColorConverter x:Key="BoolToStockColorConverter"/>
        
        <!-- Card Style -->
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="BorderBrush" Value="#E5E7EB"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="24"/>
        </Style>

        <!-- Product Card Style -->
        <Style x:Key="ProductCardStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="BorderBrush" Value="#E5E7EB"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="16"/>
        </Style>
    </Page.Resources>

    <Grid>
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Padding="32" Spacing="24">
                
                <!-- Page Header -->
                <StackPanel Spacing="8">
                    <TextBlock Text="Shopping" 
                              FontSize="32" 
                              FontWeight="SemiBold"
                              Foreground="#111827"/>
                    <TextBlock Text="Explore our complete product collection" 
                              FontSize="14" 
                              Foreground="#6B7280"/>
                </StackPanel>

                <!-- Filters Card -->
                <Border Style="{StaticResource CardStyle}">
                    <StackPanel Spacing="16">
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <FontIcon Glyph="&#xE71C;" FontSize="20" Foreground="#6B7280"/>
                            <TextBlock Text="Filters &amp; Sort" 
                                      FontSize="18" 
                                      FontWeight="SemiBold"
                                      Foreground="#111827"/>
                        </StackPanel>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Search -->
                            <StackPanel Grid.Column="0" Margin="0,0,12,0">
                                <TextBlock Text="Search" 
                                          FontSize="12" 
                                          Foreground="#6B7280" 
                                          Margin="0,0,0,8"/>
                                <TextBox PlaceholderText="Search products..."
                                        Padding="12"
                                        CornerRadius="8"/>
                            </StackPanel>

                            <!-- Category -->
                            <StackPanel Grid.Column="1" Margin="0,0,12,0">
                                <TextBlock Text="Category" 
                                          FontSize="12" 
                                          Foreground="#6B7280" 
                                          Margin="0,0,0,8"/>
                                <ComboBox PlaceholderText="All Categories"
                                         Width="180"
                                         CornerRadius="8">
                                    <ComboBoxItem Content="All Categories"/>
                                    <ComboBoxItem Content="Electronics"/>
                                    <ComboBoxItem Content="Clothing"/>
                                    <ComboBoxItem Content="Home"/>
                                    <ComboBoxItem Content="Sports"/>
                                </ComboBox>
                            </StackPanel>

                            <!-- Brand -->
                            <StackPanel Grid.Column="2" Margin="0,0,12,0">
                                <TextBlock Text="Brand" 
                                          FontSize="12" 
                                          Foreground="#6B7280" 
                                          Margin="0,0,0,8"/>
                                <ComboBox PlaceholderText="All Brands"
                                         Width="180"
                                         CornerRadius="8">
                                    <ComboBoxItem Content="All Brands"/>
                                    <ComboBoxItem Content="Apple"/>
                                    <ComboBoxItem Content="Samsung"/>
                                    <ComboBoxItem Content="Nike"/>
                                </ComboBox>
                            </StackPanel>

                            <!-- Sort -->
                            <StackPanel Grid.Column="3" Margin="0,0,12,0">
                                <TextBlock Text="Sort By" 
                                          FontSize="12" 
                                          Foreground="#6B7280" 
                                          Margin="0,0,0,8"/>
                                <ComboBox SelectedIndex="0"
                                         Width="180"
                                         CornerRadius="8">
                                    <ComboBoxItem Content="Featured"/>
                                    <ComboBoxItem Content="Price: Low to High"/>
                                    <ComboBoxItem Content="Price: High to Low"/>
                                    <ComboBoxItem Content="Name: A-Z"/>
                                    <ComboBoxItem Content="Rating"/>
                                </ComboBox>
                            </StackPanel>

                            <!-- Reset Button -->
                            <Button Grid.Column="4" 
                                   Content="Reset" 
                                   VerticalAlignment="Bottom"
                                   Padding="16,8"
                                   Background="Transparent"
                                   BorderBrush="#E5E7EB"
                                   Foreground="#DC2626"/>

                            <!-- Price Range -->
                            <StackPanel Grid.Row="1" Grid.ColumnSpan="5" Margin="0,16,0,0">
                                <TextBlock Text="Price Range" 
                                          FontSize="12" 
                                          Foreground="#6B7280" 
                                          Margin="0,0,0,8"/>
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <Slider Width="300" 
                                           Minimum="0" 
                                           Maximum="3000" 
                                           Value="0"
                                           StepFrequency="50"/>
                                    <TextBlock Text="$0 - $3000" 
                                              Foreground="#111827" 
                                              VerticalAlignment="Center"/>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Products Grid -->
                <GridView x:Name="ProductGridView"
                         SelectionMode="None" 
                         IsItemClickEnabled="False"
                         ItemsSource="{x:Bind ViewModel.Products, Mode=OneWay}">
                    <GridView.ItemsPanel>
                        <ItemsPanelTemplate>
                            <ItemsWrapGrid Orientation="Horizontal" 
                                          MaximumRowsOrColumns="4"
                                          ItemWidth="280"
                                          ItemHeight="400"/>
                        </ItemsPanelTemplate>
                    </GridView.ItemsPanel>

                    <!-- Product Card Template -->
                    <GridView.ItemTemplate>
                        <DataTemplate x:DataType="vm:ProductCardViewModel">
                            <Border Style="{StaticResource ProductCardStyle}" Width="260" Height="380">
                                <StackPanel Spacing="12">
                                    <!-- Product Image -->
                                    <Border Height="160" 
                                           CornerRadius="8" 
                                           Background="#F3F4F6"
                                           HorizontalAlignment="Stretch">
                                        <Image Source="{x:Bind ImageUrl}" 
                                              Stretch="UniformToFill"/>
                                    </Border>

                                    <!-- Product Info -->
                                    <StackPanel Spacing="8">
                                        <!-- Brand & Category -->
                                        <StackPanel Orientation="Horizontal" Spacing="8">
                                            <Border Background="#EEF2FF" 
                                                   CornerRadius="4" 
                                                   Padding="6,2">
                                                <TextBlock Text="{x:Bind Category}" 
                                                          FontSize="10" 
                                                          Foreground="#6366F1"/>
                                            </Border>
                                            <TextBlock Text="{x:Bind Manufacturer}" 
                                                      FontSize="12" 
                                                      Foreground="#6B7280"/>
                                        </StackPanel>

                                        <!-- Product Name -->
                                        <TextBlock Text="{x:Bind Name}" 
                                                  FontSize="16" 
                                                  FontWeight="SemiBold"
                                                  Foreground="#111827"
                                                  TextTrimming="CharacterEllipsis"/>

                                        <!-- Rating -->
                                        <StackPanel Orientation="Horizontal" Spacing="4">
                                            <FontIcon Glyph="&#xE735;" 
                                                     FontSize="14" 
                                                     Foreground="#F59E0B"/>
                                            <TextBlock Text="{x:Bind Rating}" 
                                                      FontSize="14" 
                                                      Foreground="#111827"/>
                                            <TextBlock FontSize="12" Foreground="#6B7280">
                                                <Run Text="("/><Run Text="{x:Bind RatingCount}"/><Run Text=")"/>
                                            </TextBlock>
                                        </StackPanel>

                                        <!-- Price & Stock -->
                                        <Grid>
                                            <StackPanel Orientation="Horizontal" 
                                                       Spacing="8" 
                                                       VerticalAlignment="Center">
                                                <TextBlock Text="{x:Bind FormattedPrice}" 
                                                          FontSize="20" 
                                                          FontWeight="Bold"
                                                          Foreground="#00AEEF"/>
                                                <Border Background="{x:Bind IsInStock, Converter={StaticResource BoolToStockColorConverter}}" 
                                                       CornerRadius="4" 
                                                       Padding="6,2">
                                                    <TextBlock Text="{x:Bind StockStatus}" 
                                                              FontSize="10" 
                                                              Foreground="White"/>
                                                </Border>
                                            </StackPanel>
                                        </Grid>

                                        <!-- Actions -->
                                        <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,8,0,0">
                                            <Button Background="#00AEEF"
                                                   Foreground="White"
                                                   Padding="12,8"
                                                   CornerRadius="8"
                                                   HorizontalAlignment="Stretch"
                                                   Width="140"
                                                   Command="{Binding ElementName=ProductGridView, Path=DataContext.AddToCartCommand}"
                                                   CommandParameter="{x:Bind}"
                                                   IsEnabled="{x:Bind IsInStock}">
                                                <StackPanel Orientation="Horizontal" Spacing="8">
                                                    <FontIcon Glyph="&#xE7BF;" FontSize="14"/>
                                                    <TextBlock Text="Add to Cart" FontSize="12"/>
                                                </StackPanel>
                                            </Button>
                                            <Button Padding="10"
                                                   Background="Transparent"
                                                   BorderBrush="#E5E7EB"
                                                   CornerRadius="8"
                                                   Command="{Binding ElementName=ProductGridView, Path=DataContext.ViewProductDetailsCommand}"
                                                   CommandParameter="{x:Bind}">
                                                <FontIcon Glyph="&#xE890;" FontSize="16" Foreground="#6B7280"/>
                                            </Button>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </GridView.ItemTemplate>
                </GridView>

                <!-- Pagination -->
                <StackPanel Orientation="Horizontal" 
                           HorizontalAlignment="Center" 
                           Spacing="8"
                           Margin="0,24,0,0">
                    <Button Content="Previous" 
                           Padding="12,8"
                           Background="White"
                           BorderBrush="#E5E7EB"
                           Foreground="#6B7280"
                           CornerRadius="8"/>
                    
                    <Button Content="1" 
                           Padding="12,8"
                           Background="#00AEEF"
                           Foreground="White"
                           CornerRadius="8"
                           Width="40"/>
                    <Button Content="2" 
                           Padding="12,8"
                           Background="White"
                           BorderBrush="#E5E7EB"
                           Foreground="#6B7280"
                           CornerRadius="8"
                           Width="40"/>
                    <Button Content="3" 
                           Padding="12,8"
                           Background="White"
                           BorderBrush="#E5E7EB"
                           Foreground="#6B7280"
                           CornerRadius="8"
                           Width="40"/>
                    
                    <Button Content="Next" 
                           Padding="12,8"
                           Background="White"
                           BorderBrush="#E5E7EB"
                           Foreground="#6B7280"
                           CornerRadius="8"/>
                </StackPanel>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>
