<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="MyShop.Client.Views.Shared.PurchaseOrdersPage"
    x:Name="PageRoot"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:buttons="using:MyShop.Client.Views.Components.Buttons"
    xmlns:badges="using:MyShop.Client.Views.Components.Badges"
    xmlns:components="using:MyShop.Client.Views.Components"
    xmlns:forms="using:MyShop.Client.Views.Components.Forms"
    xmlns:pagination="using:MyShop.Client.Views.Components.Pagination"
    xmlns:layout="using:MyShop.Client.Views.Components.Layout"
    xmlns:converters="using:MyShop.Client.Common.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels="using:MyShop.Client.ViewModels.Shared"
    mc:Ignorable="d"
    Background="{ThemeResource LayerFillColorAltBrush}">

    <Page.Transitions>
        <TransitionCollection>
            <EntranceThemeTransition FromVerticalOffset="50"/>
        </TransitionCollection>
    </Page.Transitions>

    <Page.Resources>
        <converters:StatusToVariantConverter x:Key="StatusToVariantConverter"/>
        <converters:NullToVisibilityConverter x:Key="NullToVisibilityConverter"/>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <converters:CurrencyFormatConverter x:Key="CurrencyFormatConverter"/>
        <converters:CurrencyConverter x:Key="CurrencyConverter"/>
        <Style x:Key="CardStyle"
                TargetType="Border">
            <Setter Property="Background"
                    Value="{ThemeResource CardBackgroundFillColorDefaultBrush}"/>
            <Setter Property="CornerRadius"
                    Value="12"/>
            <Setter Property="BorderBrush"
                    Value="{ThemeResource CardStrokeColorDefaultBrush}"/>
            <Setter Property="BorderThickness"
                    Value="1"/>
            <Setter Property="Padding"
                    Value="24"/>
        </Style>

        <Style x:Key="StatCardStyle"
                TargetType="Border">
            <Setter Property="Background"
                    Value="{ThemeResource CardBackgroundFillColorDefaultBrush}"/>
            <Setter Property="CornerRadius"
                    Value="12"/>
            <Setter Property="BorderBrush"
                    Value="{ThemeResource CardStrokeColorDefaultBrush}"/>
            <Setter Property="BorderThickness"
                    Value="1"/>
            <Setter Property="Padding"
                    Value="16"/>
        </Style>

        <Style x:Key="FilterToggleButtonStyle"
                TargetType="ToggleButton">
            <Setter Property="Background"
                    Value="{ThemeResource CardBackgroundFillColorDefaultBrush}"/>
            <Setter Property="Foreground"
                    Value="{ThemeResource TextFillColorSecondaryBrush}"/>
            <Setter Property="BorderBrush"
                    Value="{ThemeResource CardStrokeColorDefaultBrush}"/>
            <Setter Property="BorderThickness"
                    Value="1"/>
            <Setter Property="Padding"
                    Value="12,8"/>
            <Setter Property="CornerRadius"
                    Value="8"/>
            <Setter Property="MinWidth"
                    Value="60"/>
        </Style>
    </Page.Resources>

    <Grid>
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="ResponsiveStates">
                
                <!-- Large Desktop: 1920px+ -->
                <VisualState x:Name="LargeDesktopState">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="1920"/>
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="MainContent.Padding" Value="40"/>
                    </VisualState.Setters>
                </VisualState>

                <!-- Desktop: 1280-1919px -->
                <VisualState x:Name="DesktopState">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="1280"/>
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="MainContent.Padding" Value="32"/>
                    </VisualState.Setters>
                </VisualState>

                <!-- Tablet: 960-1279px -->
                <VisualState x:Name="TabletState">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="960"/>
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="MainContent.Padding" Value="24"/>
                    </VisualState.Setters>
                </VisualState>

                <!-- Tablet Portrait: 640-959px -->
                <VisualState x:Name="TabletPortraitState">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="640"/>
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="MainContent.Padding" Value="20"/>
                    </VisualState.Setters>
                </VisualState>

                <!-- Mobile: 0-639px (Default) -->
                <VisualState x:Name="MobileState">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="0"/>
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="MainContent.Padding" Value="16"/>
                    </VisualState.Setters>
                </VisualState>
                
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>

        <Grid RowDefinitions="Auto,*,Auto">
        <ScrollViewer Grid.Row="1"
                VerticalScrollBarVisibility="Auto">
            <StackPanel x:Name="MainContent" Padding="{StaticResource Padding_2XL}"
                    Spacing="24">

                <!-- Page Header -->
                <layout:PageHeader
                    Title="My Orders"/>

                <!-- Order Stats -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Total Orders -->
                    <Border Grid.Column="0"
                            Style="{StaticResource StatCardStyle}"
                            Margin="0,0,8,0">
                        <StackPanel Orientation="Horizontal"
                                Spacing="12">
                            <Border Width="40"
                                    Height="40"
                                    Background="{ThemeResource PurpleLightBrush}"
                                    CornerRadius="8">
                                <FontIcon Glyph="&#xF133;"
                                        FontSize="20"
                                        Foreground="{ThemeResource SecondaryBlueBrush}"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel>
                                <TextBlock Text="Total Orders"
                                        FontSize="12"
                                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                <TextBlock Text="{x:Bind ViewModel.TotalOrders, Mode=OneWay}"
                                        FontSize="18"
                                        FontWeight="SemiBold"
                                        Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Pending -->
                    <Border Grid.Column="1"
                            Style="{StaticResource StatCardStyle}"
                            Margin="4,0">
                        <StackPanel Orientation="Horizontal"
                                Spacing="12">
                            <Border Width="40"
                                    Height="40"
                                    Background="{ThemeResource SubtleFillColorSecondaryBrush}"
                                    CornerRadius="8">
                                <FontIcon Glyph="&#xE121;"
                                        FontSize="20"
                                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel>
                                <TextBlock Text="Pending"
                                        FontSize="12"
                                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                <TextBlock Text="{x:Bind ViewModel.PendingOrders, Mode=OneWay}"
                                        FontSize="18"
                                        FontWeight="SemiBold"
                                        Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- In Transit -->
                    <Border Grid.Column="2"
                            Style="{StaticResource StatCardStyle}"
                            Margin="4,0">
                        <StackPanel Orientation="Horizontal"
                                Spacing="12">
                            <Border Width="40"
                                    Height="40"
                                    Background="{ThemeResource InfoBlueLightBrush}"
                                    CornerRadius="8">
                                <FontIcon Glyph="&#xE916;"
                                        FontSize="20"
                                        Foreground="{ThemeResource AccentBlueBrush}"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel>
                                <TextBlock Text="In Transit"
                                        FontSize="12"
                                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                <TextBlock Text="{x:Bind ViewModel.InTransitOrders, Mode=OneWay}"
                                        FontSize="18"
                                        FontWeight="SemiBold"
                                        Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Delivered -->
                    <Border Grid.Column="3"
                            Style="{StaticResource StatCardStyle}"
                            Margin="4,0">
                        <StackPanel Orientation="Horizontal"
                                Spacing="12">
                            <Border Width="40"
                                    Height="40"
                                    Background="{ThemeResource SuccessGreenLightBrush}"
                                    CornerRadius="8">
                                <FontIcon Glyph="&#xE73E;"
                                        FontSize="20"
                                        Foreground="{ThemeResource SuccessGreenBrush}"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel>
                                <TextBlock Text="Delivered"
                                        FontSize="12"
                                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                <TextBlock Text="{x:Bind ViewModel.DeliveredOrders, Mode=OneWay}"
                                        FontSize="18"
                                        FontWeight="SemiBold"
                                        Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Total Spent -->
                    <Border Grid.Column="4"
                            Style="{StaticResource StatCardStyle}"
                            Margin="8,0,0,0">
                        <StackPanel Orientation="Horizontal"
                                Spacing="12">
                            <Border Width="40"
                                    Height="40"
                                    Background="{ThemeResource WarningAmberLightBrush}"
                                    CornerRadius="8">
                                <FontIcon Glyph="&#xE8C7;"
                                        FontSize="20"
                                        Foreground="{ThemeResource WarningAmberBrush}"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel>
                                <TextBlock Text="Total Spent"
                                        FontSize="12"
                                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                <TextBlock Text="{x:Bind ViewModel.TotalSpent, Converter={StaticResource CurrencyConverter}, Mode=OneWay}"
                                        FontSize="18"
                                        FontWeight="SemiBold"
                                        Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </Grid>

                <!-- Filters -->
                <Border Style="{StaticResource CardStyle}">
                    <StackPanel Spacing="16">
                        <!-- Search Box (auto complete - no button needed) -->
                        <AutoSuggestBox x:Name="SearchBox"
                                        PlaceholderText="Search by order ID, tracking, or product name..."
                                        QueryIcon="Find"
                                        Text="{x:Bind ViewModel.SearchQuery, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        TextChanged="SearchBox_TextChanged"
                                        QuerySubmitted="SearchBox_QuerySubmitted"
                                        Height="40"
                                        CornerRadius="8"/>

                        <!-- Filter Buttons and Sort -->
                        <Grid ColumnDefinitions="*,Auto">
                            <StackPanel Orientation="Horizontal"
                                    Spacing="8">
                                <ToggleButton x:Name="FilterAll"
                                        Content="All"
                                              Style="{StaticResource FilterToggleButtonStyle}"
                                              IsChecked="True"
                                              Click="FilterButton_Click"
                                        Tag="All"/>
                                <ToggleButton x:Name="FilterPending"
                                        Content="Pending"
                                              Style="{StaticResource FilterToggleButtonStyle}"
                                              Click="FilterButton_Click"
                                        Tag="Pending"/>
                                <ToggleButton x:Name="FilterPaid"
                                        Content="Paid"
                                              Style="{StaticResource FilterToggleButtonStyle}"
                                              Click="FilterButton_Click"
                                        Tag="PAID"/>
                                <ToggleButton x:Name="FilterShipped"
                                        Content="Shipped"
                                              Style="{StaticResource FilterToggleButtonStyle}"
                                              Click="FilterButton_Click"
                                        Tag="Shipped"/>
                                <ToggleButton x:Name="FilterDelivered"
                                        Content="Delivered"
                                              Style="{StaticResource FilterToggleButtonStyle}"
                                              Click="FilterButton_Click"
                                        Tag="DELIVERED"/>
                            </StackPanel>

                            <ComboBox Grid.Column="1"
                                    x:Name="SortComboBox"
                                    Width="200"
                                    PlaceholderText="Sort by"
                                      BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                    SelectionChanged="SortComboBox_SelectionChanged">
                                <ComboBoxItem Content="Newest First"
                                        IsSelected="True"/>
                                <ComboBoxItem Content="Oldest First"/>
                                <ComboBoxItem Content="Highest Amount"/>
                                <ComboBoxItem Content="Lowest Amount"/>
                            </ComboBox>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Order Cards List -->
                <ItemsRepeater x:Name="OrdersRepeater"
                        ItemsSource="{x:Bind ViewModel.Items, Mode=OneWay}">
                    <ItemsRepeater.Layout>
                        <StackLayout Spacing="16"/>
                    </ItemsRepeater.Layout>
                    <ItemsRepeater.ItemTemplate>
                        <DataTemplate x:DataType="viewmodels:OrderViewModel">
                            <Border Style="{StaticResource CardStyle}">
                                <Grid ColumnDefinitions="Auto,*,300">
                                    <!-- Left: Product Image -->
                                    <Border Width="80"
                                            Height="80"
                                            CornerRadius="8"
                                            Background="{ThemeResource SubtleFillColorSecondaryBrush}"
                                            Margin="0,0,16,0">
                                        <Image Stretch="UniformToFill">
                                            <Image.Source>
                                                <BitmapImage UriSource="{x:Bind FirstProductImage}"
                                                        DecodePixelWidth="80"/>
                                            </Image.Source>
                                        </Image>
                                    </Border>

                                    <!-- Middle: Order Info -->
                                    <StackPanel Grid.Column="1"
                                            Spacing="12">
                                        <Grid>
                                            <StackPanel>
                                                <TextBlock Text="{x:Bind ProductSummary}"
                                                        FontSize="18"
                                                        FontWeight="SemiBold"
                                                        Foreground="{ThemeResource TextFillColorPrimaryBrush}"
                                                        TextTrimming="CharacterEllipsis"
                                                        MaxWidth="400"/>
                                                <TextBlock Text="{x:Bind OrderId}"
                                                        FontSize="13"
                                                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                        Margin="0,4,0,0"/>
                                                <StackPanel Orientation="Horizontal"
                                                        Spacing="12"
                                                        Margin="0,4,0,0">
                                                    <StackPanel Orientation="Horizontal"
                                                            Spacing="4">
                                                        <FontIcon Glyph="&#xE787;"
                                                                FontSize="14"
                                                                Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                        <TextBlock Text="{x:Bind FormattedOrderDate}"
                                                                FontSize="12"
                                                                Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                    </StackPanel>
                                                    <TextBlock FontSize="12"
                                                            Foreground="{ThemeResource TextFillColorSecondaryBrush}">
                                                        <Run Text="Tracking: "/>
                                                        <Run Text="{x:Bind TrackingNumber}"/>
                                                    </TextBlock>
                                                </StackPanel>
                                            </StackPanel>
                                            
                                            <!-- Status Badge -->
                                            <badges:StatusBadge
                                                Text="{x:Bind Status}"
                                                Variant="{x:Bind Status, Mode=OneWay, Converter={StaticResource StatusToVariantConverter}}"
                                                HorizontalAlignment="Right"
                                                VerticalAlignment="Top"/>
                                        </Grid>

                                        <!-- Status Alert -->
                                        <Border Background="{ThemeResource SuccessGreenLightBrush}"
                                                Padding="{StaticResource Padding_MD}"
                                                CornerRadius="8"
                                                Visibility="{x:Bind DeliveredDate, Mode=OneWay, Converter={StaticResource NullToVisibilityConverter}}">
                                            <StackPanel Orientation="Horizontal"
                                                    Spacing="8">
                                                <FontIcon Glyph="&#xE73E;"
                                                        FontSize="16"
                                                        Foreground="{ThemeResource SuccessGreenBrush}"/>
                                                <TextBlock Text="{x:Bind DeliveryMessage}"
                                                        FontSize="14"
                                                        Foreground="{ThemeResource SuccessGreenBrush}"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>

                                    <!-- Right: Order Summary & Actions -->
                                    <StackPanel Grid.Column="2"
                                            Margin="24,0,0,0"
                                            Spacing="16">
                                        <Border Background="{ThemeResource LayerFillColorDefaultBrush}"
                                                Padding="{StaticResource Padding_LG}"
                                                CornerRadius="8">
                                            <StackPanel Spacing="12">
                                                <Grid>
                                                    <TextBlock Text="Subtotal"
                                                            FontSize="14"
                                                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                    <TextBlock Text="{x:Bind Subtotal, Converter={StaticResource CurrencyConverter}}"
                                                            FontSize="14"
                                                            Foreground="{ThemeResource TextFillColorPrimaryBrush}"
                                                            HorizontalAlignment="Right"/>
                                                </Grid>
                                                <Grid>
                                                    <TextBlock Text="Shipping"
                                                            FontSize="14"
                                                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                    <TextBlock Text="{x:Bind Shipping, Converter={StaticResource CurrencyConverter}}"
                                                            FontSize="14"
                                                            Foreground="{ThemeResource TextFillColorPrimaryBrush}"
                                                            HorizontalAlignment="Right"/>
                                                </Grid>
                                                <Grid>
                                                    <TextBlock Text="Tax"
                                                            FontSize="14"
                                                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                    <TextBlock Text="{x:Bind Tax, Converter={StaticResource CurrencyConverter}}"
                                                            FontSize="14"
                                                            Foreground="{ThemeResource TextFillColorPrimaryBrush}"
                                                            HorizontalAlignment="Right"/>
                                                </Grid>
                                                <Border Height="1"
                                                        Background="{ThemeResource CardStrokeColorDefaultBrush}"/>
                                                <Grid>
                                                    <TextBlock Text="Total"
                                                            FontSize="14"
                                                            FontWeight="SemiBold"
                                                            Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                                    <TextBlock Text="{x:Bind Total, Converter={StaticResource CurrencyConverter}}"
                                                            FontSize="18"
                                                            FontWeight="Bold"
                                                            Foreground="{ThemeResource TextFillColorPrimaryBrush}"
                                                            HorizontalAlignment="Right"/>
                                                </Grid>
                                            </StackPanel>
                                        </Border>

                                        <StackPanel Spacing="8">
                                            <buttons:IconButton
                                                    HorizontalAlignment="Stretch"
                                                    Variant="Filled"
                                                    IconGlyph="&#xE8A0;"
                                                    Text="View Details &amp; Tracking"
                                                    Command="{Binding ElementName=OrdersRepeater, Path=Tag.ViewOrderDetailsCommand}"
                                                    CommandParameter="{x:Bind}"/>
                                            <Button Style="{StaticResource SecondaryButtonStyle}"
                                                    Content="ðŸ›’ Buy Again"
                                                    HorizontalAlignment="Stretch"
                                                    Command="{Binding ElementName=OrdersRepeater, Path=Tag.BuyAgainCommand}"
                                                    CommandParameter="{x:Bind}"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsRepeater.ItemTemplate>
                </ItemsRepeater>

                <!-- Empty State -->
                    <Border Style="{StaticResource CardStyle}"
                        Visibility="{x:Bind ViewModel.HasNoItems, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Spacing="12"
                            Padding="{StaticResource Padding_3XL}">
                            <FontIcon Glyph="&#xE719;"
                                FontSize="48"
                                Foreground="{ThemeResource Gray500Brush}"/>
                            <TextBlock Text="No orders found"
                                FontSize="16"
                                FontWeight="SemiBold"
                                Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                HorizontalAlignment="Center"/>
                            <TextBlock Text="Try adjusting your search or filters"
                                FontSize="14"
                                Foreground="{ThemeResource Gray500Brush}"
                                HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
        </ScrollViewer>

        <!-- Pagination Control (TASK-08 Standardized - Customer) -->
        <Border Grid.Row="2"
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                BorderThickness="1"
                Padding="16,12"
                Margin="32,16"
                CornerRadius="8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!--  Previous Button  -->
                <Button
                    Style="{StaticResource SecondaryButtonStyle}"
                    Grid.Column="0"
                    Content="Previous"
                    IsEnabled="{x:Bind ViewModel.HasPreviousPage, Mode=OneWay}"
                    Command="{x:Bind ViewModel.PreviousPageCommand}"/>

                <!--  Page Info  -->
                <StackPanel
                    Grid.Column="1"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Spacing="4">
                    <TextBlock
                        FontSize="14"
                        FontWeight="SemiBold"
                        Foreground="{ThemeResource TextFillColorPrimaryBrush}"
                        HorizontalAlignment="Center"
                        Text="{x:Bind ViewModel.PageInfoText, Mode=OneWay}"/>
                    <TextBlock
                        FontSize="12"
                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                        HorizontalAlignment="Center"
                        Text="{x:Bind ViewModel.ItemsInfoText, Mode=OneWay}"/>
                </StackPanel>

                <!--  Next Button  -->
                <Button
                    Style="{StaticResource SecondaryButtonStyle}"
                    Grid.Column="2"
                    Content="Next"
                    IsEnabled="{x:Bind ViewModel.HasNextPage, Mode=OneWay}"
                    Command="{x:Bind ViewModel.NextPageCommand}"/>
            </Grid>
        </Border>
    </Grid>
</Grid>
</Page>
