<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="MyShop.Client.Views.Components.Forms.SearchCard"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:buttons="using:MyShop.Client.Views.Components.Buttons"
    mc:Ignorable="d"
    x:Name="RootControl">

    <!--
    SearchCard Component
    ====================
    A reusable search card with AutoSuggestBox and optional search button.
    
    Usage (Basic):
    <forms:SearchCard 
        PlaceholderText="Search products..."
        SearchText="{x:Bind ViewModel.SearchQuery, Mode=TwoWay}"
        SearchRequested="OnSearchRequested"/>
    
    Usage (With Title):
    <forms:SearchCard 
        Title="Search Users"
        Subtitle="Find users by name, email, or phone"
        PlaceholderText="Search users..."
        SearchText="{x:Bind ViewModel.SearchQuery, Mode=TwoWay}"/>
        
    Usage (With Suggestions):
    <forms:SearchCard 
        PlaceholderText="Search..."
        SearchText="{x:Bind ViewModel.SearchQuery, Mode=TwoWay}"
        ItemsSource="{x:Bind ViewModel.Suggestions}"
        SuggestionChosen="OnSuggestionChosen"/>
    -->

    <Border Style="{StaticResource CardWithShadowStyle}">
        <Grid RowSpacing="12">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            
            <!-- Title Section (optional) -->
            <StackPanel Grid.Row="0" 
                        Spacing="4"
                        Visibility="{Binding HasTitle, ElementName=RootControl, Mode=OneWay}">
                <TextBlock Text="{Binding Title, ElementName=RootControl, Mode=OneWay}"
                           FontSize="14"
                           FontWeight="SemiBold"
                           Foreground="{ThemeResource TextTertiaryBrush}"/>
                <TextBlock Text="{Binding Subtitle, ElementName=RootControl, Mode=OneWay}"
                           FontSize="12"
                           Foreground="{ThemeResource TextMutedBrush}"
                           Visibility="{Binding HasSubtitle, ElementName=RootControl, Mode=OneWay}"/>
            </StackPanel>
            
            <!-- Search Box Row -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <AutoSuggestBox x:Name="SearchAutoSuggestBox"
                               Grid.Column="0"
                               Height="40"
                               BorderBrush="{ThemeResource BorderLightBrush}"
                               CornerRadius="8"
                               QueryIcon="Find"
                               PlaceholderText="{Binding PlaceholderText, ElementName=RootControl, Mode=OneWay}"
                               Text="{Binding SearchText, ElementName=RootControl, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                               ItemsSource="{Binding ItemsSource, ElementName=RootControl, Mode=OneWay}"
                               AutomationProperties.Name="Search"
                               AutomationProperties.HelpText="{Binding PlaceholderText, ElementName=RootControl, Mode=OneWay}"
                               AccessKey="F"
                               UseSystemFocusVisuals="True"
                               TextChanged="SearchAutoSuggestBox_TextChanged"
                               SuggestionChosen="SearchAutoSuggestBox_SuggestionChosen"
                               QuerySubmitted="SearchAutoSuggestBox_QuerySubmitted"/>
                
                <buttons:IconButton x:Name="SearchButton"
                                   Grid.Column="1"
                                   Margin="12,0,0,0"
                                   Variant="Filled"
                                   IconGlyph="&#xE721;"
                                   Text="Search"
                                   Visibility="{Binding ShowSearchButton, ElementName=RootControl, Mode=OneWay}"
                                   Click="SearchButton_Click"/>
            </Grid>
        </Grid>
    </Border>
</UserControl>
