<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="MyShop.Client.Views.Components.Chat.ChatButton"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    x:Name="RootControl">

    <!--
    ChatButton Component
    ====================
    Floating chat button (bottom-right corner).
    
    Usage:
    <chat:ChatButton Click="ChatButton_Click"/>
    -->

    <Button x:Name="FloatingButton"
            Width="56" Height="56"
            CornerRadius="28"
            BorderThickness="0"
            Padding="0"
            ToolTipService.ToolTip="Chat with AI Assistant"
            AutomationProperties.Name="Open AI Chat Assistant"
            UseSystemFocusVisuals="True"
            Click="FloatingButton_Click">
        
        <Button.Template>
            <ControlTemplate TargetType="Button">
                <Grid>
                    <Ellipse x:Name="RootEllipse"
                            Fill="{TemplateBinding Background}"
                            Width="56" Height="56"/>
                    
                    <ContentPresenter x:Name="ContentPresenter"
                                    Content="{TemplateBinding Content}"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"/>
                    
                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroup x:Name="CommonStates">
                            
                            <VisualState x:Name="Normal"/>
                            
                            <VisualState x:Name="PointerOver">
                                <VisualState.Setters>
                                    <Setter Target="RootEllipse.Fill" Value="{ThemeResource PrimaryHoverBrush}"/>
                                </VisualState.Setters>
                            </VisualState>
                            
                            <VisualState x:Name="Pressed">
                                <VisualState.Setters>
                                    <Setter Target="RootEllipse.Fill" Value="{ThemeResource PrimaryPressedBrush}"/>
                                </VisualState.Setters>
                            </VisualState>
                            
                            <VisualState x:Name="Disabled">
                                <VisualState.Setters>
                                    <Setter Target="RootEllipse.Fill" Value="{ThemeResource ControlFillColorDisabledBrush}"/>
                                </VisualState.Setters>
                            </VisualState>
                        </VisualStateGroup>
                    </VisualStateManager.VisualStateGroups>
                </Grid>
            </ControlTemplate>
        </Button.Template>
        
        <Button.Shadow>
            <ThemeShadow/>
        </Button.Shadow>
        
        <Grid>
            <!-- Chat Icon -->
            <FontIcon x:Name="ChatIcon" 
                     Glyph="&#xE8BD;" 
                     FontSize="24">
                <FontIcon.Foreground>
                    <SolidColorBrush x:Name="ChatIconBrush" Color="White"/>
                </FontIcon.Foreground>
            </FontIcon>
            
            <!-- Close Icon (when open) -->
            <FontIcon x:Name="CloseIcon" 
                     Glyph="&#xE711;" 
                     FontSize="20"
                     Visibility="Collapsed">
                <FontIcon.Foreground>
                    <SolidColorBrush x:Name="CloseIconBrush" Color="White"/>
                </FontIcon.Foreground>
            </FontIcon>
            
            <!-- Notification Badge -->
            <Border x:Name="NotificationBadge"
                   Width="18" Height="18"
                   CornerRadius="9"
                   Background="{ThemeResource ErrorRedBrush}"
                   HorizontalAlignment="Right"
                   VerticalAlignment="Top"
                   Margin="0,-4,-4,0"
                   Visibility="Collapsed">
                <TextBlock Text="1" 
                          FontSize="10" 
                          FontWeight="Bold"
                          Foreground="White"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"/>
            </Border>
        </Grid>
    </Button>
</UserControl>
