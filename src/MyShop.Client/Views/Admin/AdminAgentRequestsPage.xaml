<?xml version="1.0" encoding="utf-8" ?>
<Page
    x:Class="MyShop.Client.Views.Admin.AdminAgentRequestsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:badges="using:MyShop.Client.Views.Components.Badges"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels="using:MyShop.Client.ViewModels.Admin"
    Background="#F3F4F6"
    mc:Ignorable="d">

    <!--  Sau khi hoàn thiện sẽ chuyển vào Resource dùng chung  -->
    <Page.Resources>

        <Style x:Key="TabRadioButtonStyle" TargetType="RadioButton">
            <!--  Base  -->
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="#4B5563" />
            <!--  gray-600  -->
            <Setter Property="Padding" Value="14,6" />
            <Setter Property="HorizontalAlignment" Value="Left" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="BorderThickness" Value="0" />

            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Grid>
                            <!--  Pill  -->
                            <Border
                                x:Name="Root"
                                Padding="{TemplateBinding Padding}"
                                Background="{TemplateBinding Background}"
                                BorderBrush="Transparent"
                                BorderThickness="0"
                                CornerRadius="12">
                                <ContentPresenter
                                    x:Name="ContentPresenter"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Content="{TemplateBinding Content}"
                                    ContentTemplate="{TemplateBinding ContentTemplate}"
                                    Foreground="{TemplateBinding Foreground}" />
                            </Border>

                            <VisualStateManager.VisualStateGroups>

                                <!--  Hover / Press / Disabled  -->
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal" />

                                    <!--  HOVER: hơi sáng hơn, text đậm hơn  -->
                                    <VisualState x:Name="PointerOver">
                                        <VisualState.Setters>
                                            <Setter Target="Root.Opacity" Value="0.95" />
                                            <Setter Target="ContentPresenter.Foreground" Value="#111827" />
                                            <!--  gray-900  -->
                                        </VisualState.Setters>
                                    </VisualState>

                                    <!--  PRESSED: tối thêm chút nữa  -->
                                    <VisualState x:Name="Pressed">
                                        <VisualState.Setters>
                                            <Setter Target="Root.Opacity" Value="0.85" />
                                            <Setter Target="ContentPresenter.Foreground" Value="#111827" />
                                        </VisualState.Setters>
                                    </VisualState>

                                    <VisualState x:Name="Disabled">
                                        <VisualState.Setters>
                                            <Setter Target="Root.Opacity" Value="0.4" />
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>

                                <!--  Checked / Unchecked  -->
                                <VisualStateGroup x:Name="CheckStates">
                                    <!--  UNCHECKED: nền trong suốt, chữ xám  -->
                                    <VisualState x:Name="Unchecked">
                                        <VisualState.Setters>
                                            <Setter Target="Root.Background" Value="Transparent" />
                                            <Setter Target="ContentPresenter.Foreground" Value="#4B5563" />
                                            <Setter Target="Root.Opacity" Value="1" />
                                        </VisualState.Setters>
                                    </VisualState>

                                    <!--  ACTIVE: fill đầy bằng accent, chữ trắng  -->
                                    <VisualState x:Name="Checked">
                                        <VisualState.Setters>
                                            <Setter Target="Root.Background" Value="{ThemeResource AccentFillColorDefaultBrush}" />
                                            <Setter Target="ContentPresenter.Foreground" Value="{ThemeResource TextOnAccentFillColorPrimaryBrush}" />
                                            <Setter Target="Root.Opacity" Value="1" />
                                        </VisualState.Setters>
                                    </VisualState>

                                    <VisualState x:Name="Indeterminate" />
                                </VisualStateGroup>

                            </VisualStateManager.VisualStateGroups>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </Page.Resources>





    <Grid Padding="32">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!--  Header  -->
        <Grid Grid.Row="0" Margin="0,0,0,24">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0">
                <TextBlock
                    FontSize="28"
                    FontWeight="SemiBold"
                    Text="Agent Requests" />
                <TextBlock
                    Margin="0,4,0,0"
                    FontSize="14"
                    Foreground="#6B7280"
                    Text="Manage salesman registration requests" />
            </StackPanel>

            <Button
                Grid.Column="1"
                VerticalAlignment="Center"
                Command="{x:Bind ViewModel.RefreshCommand}"
                Style="{StaticResource AccentButtonStyle}">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <FontIcon FontSize="16" Glyph="&#xE72C;" />
                    <TextBlock Text="Refresh" />
                </StackPanel>
            </Button>
        </Grid>

        <!--  Status Tabs  -->
        <Border
            Grid.Row="1"
            Margin="0,0,0,16"
            Padding="4"
            HorizontalAlignment="Left"
            Background="White"
            BorderBrush="#E5E7EB"
            BorderThickness="1"
            CornerRadius="12">
            <StackPanel Orientation="Horizontal" Spacing="12">
                <RadioButton
                    Command="{x:Bind ViewModel.FilterByStatusCommand}"
                    CommandParameter="All"
                    Content="All Requests"
                    GroupName="StatusTabs"
                    IsChecked="{x:Bind ViewModel.IsAllTabSelected, Mode=TwoWay}"
                    Style="{StaticResource TabRadioButtonStyle}" />
                <RadioButton
                    Command="{x:Bind ViewModel.FilterByStatusCommand}"
                    CommandParameter="Pending"
                    Content="Pending"
                    GroupName="StatusTabs"
                    IsChecked="{x:Bind ViewModel.IsPendingTabSelected, Mode=TwoWay}"
                    Style="{StaticResource TabRadioButtonStyle}" />
                <RadioButton
                    Command="{x:Bind ViewModel.FilterByStatusCommand}"
                    CommandParameter="Approved"
                    Content="Approved"
                    GroupName="StatusTabs"
                    IsChecked="{x:Bind ViewModel.IsApprovedTabSelected, Mode=TwoWay}"
                    Style="{StaticResource TabRadioButtonStyle}" />
                <RadioButton
                    Command="{x:Bind ViewModel.FilterByStatusCommand}"
                    CommandParameter="Rejected"
                    Content="Rejected"
                    GroupName="StatusTabs"
                    IsChecked="{x:Bind ViewModel.IsRejectedTabSelected, Mode=TwoWay}"
                    Style="{StaticResource TabRadioButtonStyle}" />
            </StackPanel>
        </Border>

        <!--  Requests Table  -->
        <Border
            Grid.Row="2"
            Padding="24"
            Background="White"
            BorderBrush="#E5E7EB"
            BorderThickness="1"
            CornerRadius="16">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!--  Table Header  -->
                <Grid
                    Grid.Row="0"
                    Margin="0,0,0,12"
                    Padding="12,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="1.5*" />
                        <ColumnDefinition Width="1.2*" />
                        <ColumnDefinition Width="1*" />
                        <ColumnDefinition Width="1*" />
                        <ColumnDefinition Width="1.5*" />
                    </Grid.ColumnDefinitions>

                    <TextBlock
                        Grid.Column="0"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Foreground="#6B7280"
                        Text="Name" />
                    <TextBlock
                        Grid.Column="1"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Foreground="#6B7280"
                        Text="Email" />
                    <TextBlock
                        Grid.Column="2"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Foreground="#6B7280"
                        Text="Phone" />
                    <TextBlock
                        Grid.Column="3"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Foreground="#6B7280"
                        Text="Submitted" />
                    <TextBlock
                        Grid.Column="4"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Foreground="#6B7280"
                        Text="Experience" />
                    <TextBlock
                        Grid.Column="5"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Foreground="#6B7280"
                        Text="Status" />
                    <TextBlock
                        Grid.Column="6"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Foreground="#6B7280"
                        Text="Actions"
                        TextAlignment="Right" />
                </Grid>

                <!--  Requests List  -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <ItemsRepeater ItemsSource="{x:Bind ViewModel.FilteredRequests, Mode=OneWay}">
                        <ItemsRepeater.Layout>
                            <StackLayout Spacing="8" />
                        </ItemsRepeater.Layout>
                        <ItemsRepeater.ItemTemplate>
                            <DataTemplate x:DataType="viewmodels:AgentRequestItem">
                                <Border
                                    Padding="12"
                                    Background="{ThemeResource SubtleFillColorSecondaryBrush}"
                                    BorderBrush="#E5E7EB"
                                    BorderThickness="1"
                                    CornerRadius="8">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="2*" />
                                            <ColumnDefinition Width="2*" />
                                            <ColumnDefinition Width="1.5*" />
                                            <ColumnDefinition Width="1.2*" />
                                            <ColumnDefinition Width="1*" />
                                            <ColumnDefinition Width="1*" />
                                            <ColumnDefinition Width="1.5*" />
                                        </Grid.ColumnDefinitions>

                                        <!--  Name + Avatar  -->
                                        <StackPanel
                                            Grid.Column="0"
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal"
                                            Spacing="12">
                                            <PersonPicture
                                                Width="40"
                                                Height="40"
                                                ProfilePicture="{x:Bind Avatar}" />
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock
                                                    FontSize="14"
                                                    FontWeight="SemiBold"
                                                    Text="{x:Bind FullName}" />
                                                <TextBlock
                                                    FontSize="12"
                                                    Foreground="#6B7280"
                                                    Text="{x:Bind Username}" />
                                            </StackPanel>
                                        </StackPanel>

                                        <!--  Email  -->
                                        <TextBlock
                                            Grid.Column="1"
                                            VerticalAlignment="Center"
                                            FontSize="13"
                                            Text="{x:Bind Email}" />

                                        <!--  Phone  -->
                                        <TextBlock
                                            Grid.Column="2"
                                            VerticalAlignment="Center"
                                            FontSize="13"
                                            Text="{x:Bind Phone}" />

                                        <!--  Submitted Date  -->
                                        <TextBlock
                                            Grid.Column="3"
                                            VerticalAlignment="Center"
                                            FontSize="13"
                                            Foreground="#6B7280"
                                            Text="{x:Bind SubmittedDate}" />

                                        <!--  Experience  -->
                                        <TextBlock
                                            Grid.Column="4"
                                            VerticalAlignment="Center"
                                            FontSize="13"
                                            Text="{x:Bind Experience}" />

                                        <!--  Status Badge  -->
                                        <badges:StatusBadge
                                            Grid.Column="5"
                                            VerticalAlignment="Center"
                                            Text="{x:Bind Status}"
                                            Variant="Warning" />

                                        <!--  Actions  -->
                                        <StackPanel
                                            Grid.Column="6"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal"
                                            Spacing="8">
                                            <Button
                                                Command="{Binding DataContext.ApproveRequestCommand, ElementName=MyPage}"
                                                CommandParameter="{x:Bind}"
                                                Style="{StaticResource SmallSuccessButtonStyle}"
                                                Visibility="{x:Bind IsPending}">
                                                <StackPanel Orientation="Horizontal" Spacing="6">
                                                    <FontIcon FontSize="14" Glyph="&#xE73E;" />
                                                    <TextBlock Text="Approve" />
                                                </StackPanel>
                                            </Button>
                                            <Button
                                                Command="{Binding DataContext.RejectRequestCommand, ElementName=MyPage}"
                                                CommandParameter="{x:Bind}"
                                                Style="{StaticResource SmallDangerButtonStyle}"
                                                Visibility="{x:Bind IsPending}">
                                                <StackPanel Orientation="Horizontal" Spacing="6">
                                                    <FontIcon FontSize="14" Glyph="&#xE711;" />
                                                    <TextBlock Text="Reject" />
                                                </StackPanel>
                                            </Button>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsRepeater.ItemTemplate>
                    </ItemsRepeater>
                </ScrollViewer>
            </Grid>
        </Border>
    </Grid>
</Page>
