<?xml version="1.0" encoding="utf-8" ?>
<Page
    x:Class="MyShop.Client.Views.Admin.AdminAgentRequestsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:badges="using:MyShop.Client.Views.Components.Badges"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels="using:MyShop.Client.ViewModels.Admin"
    Background="#F3F4F6"
    mc:Ignorable="d">

    <Page.Resources>
        <!-- No custom styles needed - TabView uses built-in WinUI 3 styles -->
    </Page.Resources>





    <Grid Padding="32">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!--  Header  -->
        <Grid Grid.Row="0" Margin="0,0,0,24">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0">
                <TextBlock
                    Style="{StaticResource DisplayHeadingStyle}"
                    Text="Agent Requests" />
                <TextBlock
                    Margin="0,4,0,0"
                    FontSize="14"
                    Foreground="#6B7280"
                    Text="Manage salesman registration requests" />
            </StackPanel>

            <Button
                Grid.Column="1"
                VerticalAlignment="Center"
                Command="{x:Bind ViewModel.RefreshCommand}"
                Style="{StaticResource AccentButtonStyle}">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <FontIcon FontSize="16" Glyph="&#xE72C;" />
                    <TextBlock Text="Refresh" />
                </StackPanel>
            </Button>
        </Grid>

        <!--  Status Tabs - Using TabView  -->
        <TabView
            Grid.Row="1"
            Margin="0,0,0,16"
            IsAddTabButtonVisible="False"
            SelectedIndex="{x:Bind ViewModel.SelectedTabIndex, Mode=TwoWay}"
            TabWidthMode="SizeToContent">
            
            <!--  All Requests Tab  -->
            <TabViewItem Header="All Requests" IsClosable="False">
                <TabViewItem.IconSource>
                    <FontIconSource Glyph="&#xE8FD;" />
                </TabViewItem.IconSource>
            </TabViewItem>

            <!--  Pending Tab  -->
            <TabViewItem Header="Pending" IsClosable="False">
                <TabViewItem.IconSource>
                    <FontIconSource Glyph="&#xE9F5;" />
                </TabViewItem.IconSource>
            </TabViewItem>

            <!--  Approved Tab  -->
            <TabViewItem Header="Approved" IsClosable="False">
                <TabViewItem.IconSource>
                    <FontIconSource Glyph="&#xE73E;" />
                </TabViewItem.IconSource>
            </TabViewItem>

            <!--  Rejected Tab  -->
            <TabViewItem Header="Rejected" IsClosable="False">
                <TabViewItem.IconSource>
                    <FontIconSource Glyph="&#xE711;" />
                </TabViewItem.IconSource>
            </TabViewItem>
        </TabView>

        <!--  Requests Table  -->
        <Border
            Grid.Row="2"
            Padding="24"
            Background="White"
            BorderBrush="#E5E7EB"
            BorderThickness="1"
            CornerRadius="16">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!--  Table Header  -->
                <Grid
                    Grid.Row="0"
                    Margin="0,0,0,12"
                    Padding="12,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="1.5*" />
                        <ColumnDefinition Width="1.2*" />
                        <ColumnDefinition Width="1*" />
                        <ColumnDefinition Width="1*" />
                        <ColumnDefinition Width="1.5*" />
                    </Grid.ColumnDefinitions>

                    <TextBlock
                        Grid.Column="0"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Foreground="#6B7280"
                        Text="Name" />
                    <TextBlock
                        Grid.Column="1"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Foreground="#6B7280"
                        Text="Email" />
                    <TextBlock
                        Grid.Column="2"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Foreground="#6B7280"
                        Text="Phone" />
                    <TextBlock
                        Grid.Column="3"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Foreground="#6B7280"
                        Text="Submitted" />
                    <TextBlock
                        Grid.Column="4"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Foreground="#6B7280"
                        Text="Experience" />
                    <TextBlock
                        Grid.Column="5"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Foreground="#6B7280"
                        Text="Status" />
                    <TextBlock
                        Grid.Column="6"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Foreground="#6B7280"
                        Text="Actions"
                        TextAlignment="Right" />
                </Grid>

                <!--  Requests List  -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <ItemsRepeater ItemsSource="{x:Bind ViewModel.FilteredRequests, Mode=OneWay}">
                        <ItemsRepeater.Layout>
                            <StackLayout Spacing="8" />
                        </ItemsRepeater.Layout>
                        <ItemsRepeater.ItemTemplate>
                            <DataTemplate x:DataType="viewmodels:AgentRequestItem">
                                <Border
                                    Padding="12"
                                    Background="{ThemeResource SubtleFillColorSecondaryBrush}"
                                    BorderBrush="#E5E7EB"
                                    BorderThickness="1"
                                    CornerRadius="8">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="2*" />
                                            <ColumnDefinition Width="2*" />
                                            <ColumnDefinition Width="1.5*" />
                                            <ColumnDefinition Width="1.2*" />
                                            <ColumnDefinition Width="1*" />
                                            <ColumnDefinition Width="1*" />
                                            <ColumnDefinition Width="1.5*" />
                                        </Grid.ColumnDefinitions>

                                        <!--  Name + Avatar  -->
                                        <StackPanel
                                            Grid.Column="0"
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal"
                                            Spacing="12">
                                            <PersonPicture
                                                Width="40"
                                                Height="40"
                                                ProfilePicture="{x:Bind Avatar}" />
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock
                                                    FontSize="14"
                                                    FontWeight="SemiBold"
                                                    Text="{x:Bind FullName}" />
                                                <TextBlock
                                                    FontSize="12"
                                                    Foreground="#6B7280"
                                                    Text="{x:Bind Username}" />
                                            </StackPanel>
                                        </StackPanel>

                                        <!--  Email  -->
                                        <TextBlock
                                            Grid.Column="1"
                                            VerticalAlignment="Center"
                                            FontSize="13"
                                            Text="{x:Bind Email}" />

                                        <!--  Phone  -->
                                        <TextBlock
                                            Grid.Column="2"
                                            VerticalAlignment="Center"
                                            FontSize="13"
                                            Text="{x:Bind Phone}" />

                                        <!--  Submitted Date  -->
                                        <TextBlock
                                            Grid.Column="3"
                                            VerticalAlignment="Center"
                                            FontSize="13"
                                            Foreground="#6B7280"
                                            Text="{x:Bind SubmittedDate}" />

                                        <!--  Experience  -->
                                        <TextBlock
                                            Grid.Column="4"
                                            VerticalAlignment="Center"
                                            FontSize="13"
                                            Text="{x:Bind Experience}" />

                                        <!--  Status Badge  -->
                                        <badges:StatusBadge
                                            Grid.Column="5"
                                            VerticalAlignment="Center"
                                            Text="{x:Bind Status}"
                                            Variant="Warning" />

                                        <!--  Actions  -->
                                        <StackPanel
                                            Grid.Column="6"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal"
                                            Spacing="8">
                                            <Button
                                                Command="{Binding DataContext.ApproveRequestCommand, ElementName=MyPage}"
                                                CommandParameter="{x:Bind}"
                                                Style="{StaticResource SmallSuccessButtonStyle}"
                                                Visibility="{x:Bind IsPending}">
                                                <StackPanel Orientation="Horizontal" Spacing="6">
                                                    <FontIcon FontSize="14" Glyph="&#xE73E;" />
                                                    <TextBlock Text="Approve" />
                                                </StackPanel>
                                            </Button>
                                            <Button
                                                Command="{Binding DataContext.RejectRequestCommand, ElementName=MyPage}"
                                                CommandParameter="{x:Bind}"
                                                Style="{StaticResource SmallDangerButtonStyle}"
                                                Visibility="{x:Bind IsPending}">
                                                <StackPanel Orientation="Horizontal" Spacing="6">
                                                    <FontIcon FontSize="14" Glyph="&#xE711;" />
                                                    <TextBlock Text="Reject" />
                                                </StackPanel>
                                            </Button>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsRepeater.ItemTemplate>
                    </ItemsRepeater>
                </ScrollViewer>
            </Grid>
        </Border>
    </Grid>
</Page>
