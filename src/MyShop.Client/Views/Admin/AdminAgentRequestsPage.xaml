<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="MyShop.Client.Views.Admin.AdminAgentRequestsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels="using:MyShop.Client.ViewModels.Admin"
    xmlns:badges="using:MyShop.Client.Views.Components.Badges"
    mc:Ignorable="d"
    Background="#F3F4F6">

    <Grid Padding="32">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Grid Grid.Row="0" Margin="0,0,0,24">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0">
                <TextBlock Text="Agent Requests" FontSize="28" FontWeight="SemiBold"/>
                <TextBlock Text="Manage salesman registration requests" FontSize="14" Foreground="#6B7280" Margin="0,4,0,0"/>
            </StackPanel>

            <Button Grid.Column="1" 
                    Style="{StaticResource AccentButtonStyle}"
                    VerticalAlignment="Center"
                    Command="{x:Bind ViewModel.RefreshCommand}">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <FontIcon Glyph="&#xE72C;" FontSize="16"/>
                    <TextBlock Text="Refresh"/>
                </StackPanel>
            </Button>
        </Grid>

        <!-- Status Tabs -->
        <Border Grid.Row="1" 
                Background="White" 
                CornerRadius="12" 
                BorderBrush="#E5E7EB" 
                BorderThickness="1"
                Padding="20"
                Margin="0,0,0,16">
            <StackPanel Orientation="Horizontal" Spacing="12">
                <RadioButton Content="All Requests" 
                             GroupName="StatusTabs"
                             IsChecked="{x:Bind ViewModel.IsAllTabSelected, Mode=TwoWay}"
                             Command="{x:Bind ViewModel.FilterByStatusCommand}"
                             CommandParameter="All"
                             Style="{StaticResource TabRadioButtonStyle}"/>
                <RadioButton Content="Pending" 
                             GroupName="StatusTabs"
                             IsChecked="{x:Bind ViewModel.IsPendingTabSelected, Mode=TwoWay}"
                             Command="{x:Bind ViewModel.FilterByStatusCommand}"
                             CommandParameter="Pending"
                             Style="{StaticResource TabRadioButtonStyle}"/>
                <RadioButton Content="Approved" 
                             GroupName="StatusTabs"
                             IsChecked="{x:Bind ViewModel.IsApprovedTabSelected, Mode=TwoWay}"
                             Command="{x:Bind ViewModel.FilterByStatusCommand}"
                             CommandParameter="Approved"
                             Style="{StaticResource TabRadioButtonStyle}"/>
                <RadioButton Content="Rejected" 
                             GroupName="StatusTabs"
                             IsChecked="{x:Bind ViewModel.IsRejectedTabSelected, Mode=TwoWay}"
                             Command="{x:Bind ViewModel.FilterByStatusCommand}"
                             CommandParameter="Rejected"
                             Style="{StaticResource TabRadioButtonStyle}"/>
            </StackPanel>
        </Border>

        <!-- Requests Table -->
        <Border Grid.Row="2"
                Background="White" 
                CornerRadius="16" 
                BorderBrush="#E5E7EB" 
                BorderThickness="1"
                Padding="24">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Table Header -->
                <Grid Grid.Row="0" Padding="12,0" Margin="0,0,0,12">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="1.5*"/>
                        <ColumnDefinition Width="1.2*"/>
                        <ColumnDefinition Width="1*"/>
                        <ColumnDefinition Width="1*"/>
                        <ColumnDefinition Width="1.5*"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0" Text="Name" FontWeight="SemiBold" Foreground="#6B7280" FontSize="13"/>
                    <TextBlock Grid.Column="1" Text="Email" FontWeight="SemiBold" Foreground="#6B7280" FontSize="13"/>
                    <TextBlock Grid.Column="2" Text="Phone" FontWeight="SemiBold" Foreground="#6B7280" FontSize="13"/>
                    <TextBlock Grid.Column="3" Text="Submitted" FontWeight="SemiBold" Foreground="#6B7280" FontSize="13"/>
                    <TextBlock Grid.Column="4" Text="Experience" FontWeight="SemiBold" Foreground="#6B7280" FontSize="13"/>
                    <TextBlock Grid.Column="5" Text="Status" FontWeight="SemiBold" Foreground="#6B7280" FontSize="13"/>
                    <TextBlock Grid.Column="6" Text="Actions" FontWeight="SemiBold" Foreground="#6B7280" FontSize="13" TextAlignment="Right"/>
                </Grid>

                <!-- Requests List -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <ItemsRepeater ItemsSource="{x:Bind ViewModel.FilteredRequests, Mode=OneWay}">
                        <ItemsRepeater.Layout>
                            <StackLayout Spacing="8"/>
                        </ItemsRepeater.Layout>
                        <ItemsRepeater.ItemTemplate>
                            <DataTemplate x:DataType="viewmodels:AgentRequestItem">
                                <Border Background="{ThemeResource SubtleFillColorSecondaryBrush}"
                                        CornerRadius="8"
                                        Padding="12"
                                        BorderBrush="#E5E7EB"
                                        BorderThickness="1">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="2*"/>
                                            <ColumnDefinition Width="2*"/>
                                            <ColumnDefinition Width="1.5*"/>
                                            <ColumnDefinition Width="1.2*"/>
                                            <ColumnDefinition Width="1*"/>
                                            <ColumnDefinition Width="1*"/>
                                            <ColumnDefinition Width="1.5*"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Name + Avatar -->
                                        <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="12" VerticalAlignment="Center">
                                            <PersonPicture ProfilePicture="{x:Bind Avatar}" Width="40" Height="40"/>
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="{x:Bind FullName}" FontWeight="SemiBold" FontSize="14"/>
                                                <TextBlock Text="{x:Bind Username}" FontSize="12" Foreground="#6B7280"/>
                                            </StackPanel>
                                        </StackPanel>

                                        <!-- Email -->
                                        <TextBlock Grid.Column="1" Text="{x:Bind Email}" VerticalAlignment="Center" FontSize="13"/>

                                        <!-- Phone -->
                                        <TextBlock Grid.Column="2" Text="{x:Bind Phone}" VerticalAlignment="Center" FontSize="13"/>

                                        <!-- Submitted Date -->
                                        <TextBlock Grid.Column="3" Text="{x:Bind SubmittedDate}" VerticalAlignment="Center" FontSize="13" Foreground="#6B7280"/>

                                        <!-- Experience -->
                                        <TextBlock Grid.Column="4" Text="{x:Bind Experience}" VerticalAlignment="Center" FontSize="13"/>

                                        <!-- Status Badge -->
                                        <badges:StatusBadge Grid.Column="5" 
                                                           Text="{x:Bind Status}" 
                                                           Variant="Warning"
                                                           VerticalAlignment="Center"/>

                                        <!-- Actions -->
                                        <StackPanel Grid.Column="6" Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right" VerticalAlignment="Center">
                                            <Button Command="{Binding DataContext.ApproveRequestCommand, ElementName=MyPage}"
                                                    CommandParameter="{x:Bind}"
                                                    Visibility="{x:Bind IsPending}"
                                                    Style="{StaticResource SmallSuccessButtonStyle}">
                                                <StackPanel Orientation="Horizontal" Spacing="6">
                                                    <FontIcon Glyph="&#xE73E;" FontSize="14"/>
                                                    <TextBlock Text="Approve"/>
                                                </StackPanel>
                                            </Button>
                                            <Button Command="{Binding DataContext.RejectRequestCommand, ElementName=MyPage}"
                                                    CommandParameter="{x:Bind}"
                                                    Visibility="{x:Bind IsPending}"
                                                    Style="{StaticResource SmallDangerButtonStyle}">
                                                <StackPanel Orientation="Horizontal" Spacing="6">
                                                    <FontIcon Glyph="&#xE711;" FontSize="14"/>
                                                    <TextBlock Text="Reject"/>
                                                </StackPanel>
                                            </Button>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsRepeater.ItemTemplate>
                    </ItemsRepeater>
                </ScrollViewer>
            </Grid>
        </Border>
    </Grid>
</Page>
